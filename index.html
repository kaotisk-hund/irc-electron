<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
  <head>
  	<title>KiRc</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/foundation.css">
    <link rel="stylesheet" href="assets/css/app.css">
  </head>
<body>
	<div class="grid-x">
		<div class="small-7 cell">
			<div class="output">
		<div>
			<h2>Messages</h2>
		</div>
		<div class="messages">
		</div>
		<div class="send">
			<form id="messaging">
				<input type="text" id="message" placeholder="Enter your message here...">
				<button class="button" type="submit">Send</button>
			</form>
		</div>
	</div>
		</div>
		<div class="small-5 cell">
			<div class="stats">
			<h1>Settings</h1>
			<form id="settings">
				<input type="text" id="nickname" placeholder="Nickname" value="guest"/>
				<input type="text" id="server" placeholder="Server" value="irc.kaotisk-hund.tk"/>
				<input type="text" id="channel" placeholder="Channel e.g. #general" value="#general"/>
				<button class="button" type="submit">Connect!</button>
			</form>
		</div>
		</div>
	</div>
	

	
	<script>
		const electron = require('electron');
    	const {ipcRenderer} = electron;

    	document.querySelector('#messaging').addEventListener('submit', sendMessage);
    	function sendMessage(e){
    		e.preventDefault();
    		const message = document.querySelector('#message').value;

    		ipcRenderer.send('irc_send', message);
    	}

		document.querySelector('#settings').addEventListener('submit', submitForm);
	    function submitForm(e){
	      e.preventDefault();
	      const nickname = document.querySelector('#nickname').value;
	      const server = document.querySelector('#server').value;
	      const channel = document.querySelector('#channel').value;

	      const thadata = {server, nickname, channel}

	      ipcRenderer.send('irc_connect', thadata);
	    }

	    const div = document.querySelector('.messages');

	    ipcRenderer.on('irc_message', function(e, data){
	      const p = document.createElement('p');
	      p.className = 'message';
	      const message = document.createTextNode(data.from + ": " + data.message);
	      p.appendChild(message);
	      div.appendChild(p);
	    });
		

	</script>
</body>
</html>
